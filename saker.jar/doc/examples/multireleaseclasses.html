<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Multi-release Java classes&nbsp;|&nbsp;saker.jar</title>
	
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"/>
	
	<link rel="stylesheet" href="../../../res/bootstrap.min.css" >
	<link rel="stylesheet" href="../../../res/doc-saker.css" >

	<script type="application/ld+json">
	{
	  "@context": "https://schema.org",
	  "@type": "WebSite",
	  "name": "saker.jar",
	  "url": "https://saker.build/saker.jar"
	}
	</script>
</head>
<body data-nav-location="packagedoc" data-subdoc-presence="nest-package packagedoc taskdoc">
<div class="doc-nav-bar">
	<div class="container">
		<a class="home-link" href="../../index.html" title="saker.jar"><img style="height: 2.5em;" class="logo" src="../../../res/logo.svg"/><span class="page-name">saker.jar</span></a>
		<a class="nav-location-item" data-nav-location="doc-docs" href="../../doc/index.html" title="Documentation">Documentation</a>
		<a class="nav-location-item" data-nav-location="doc-taskdoc" href="../../taskdoc/index.html" title="Build task documentation">TaskDoc</a>
		<a class="nav-location-item" data-nav-location="doc-javadoc" href="../../javadoc/index.html"title="Java API documentation">JavaDoc</a>
		<div class="nav-bar-controls">
			<label class="d-xl-none nav-bar-collapse" for="collapse-nav-bar-label">
				<svg style="height: 1.5em;" viewBox="0 0 24 24">
				    <path fill="currentColor" d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z" />
				</svg>
			</label>
			<input style="display:none;" id="collapse-nav-bar-label" type="checkbox"/>
			<div class="nav-bar-items">
				<a href="/" title="saker.build home page">Home</a>
				<a href="/buildtrace.html" title="Build trace viewer">Build trace</a>
				<a style="display:none;" href="/sponsor.html" title="Sponsoring development">Sponsor</a>
				<a href="/blog/" title="saker.build system blog">Blog</a>
				<a class="no-external-icon" href="https://github.com/sakerbuild/saker.build" title="saker.build GitHub repository">GitHub</a>
			</div>
		</div>
	</div>
</div>
<div class="container page-contents packagedoc">
	<div class="row">
		<div class="col-12 col-lg-3 col-xl-2 p-lg-0">
			<div class="doc-navigation-container">
				<label class="d-lg-none nav-collapse" for="doc-collapse-nav-label">
					<svg style="height: 1.5em;" viewBox="0 0 24 24">
					    <path fill="currentColor" d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z" />
					</svg>
					Navigation
				</label>
				<input style="display:none;" id="doc-collapse-nav-label" type="checkbox"/> 
				<div class="doc-nav">  <div class="doc-section"><ul><li><a class="doc-nav-section-link" href="../../index.html" title="Index">Index</a></li></ul>  </div>  <div class="doc-section">    <p class="section-title">Package details</p><ul><li><a class="doc-nav-section-link" href="../index.html" title="Overview">Overview</a></li><li><a class="doc-nav-section-link" href="../gettingstarted.html" title="Getting started">Getting started</a></li></ul>  </div>  <div class="doc-section">    <p class="section-title">JAR creation</p><ul><li><a class="doc-nav-section-link" href="../jarcreation/index.html" title="Basics">Basics</a></li><li><a class="doc-nav-section-link" href="../jarcreation/contents.html" title="Contents">Contents</a></li><li><a class="doc-nav-section-link" href="../jarcreation/manifest.html" title="Manifest">Manifest</a></li><li><a class="doc-nav-section-link" href="../jarcreation/services.html" title="Services">Services</a></li><li><a class="doc-nav-section-link" href="../jarcreation/multirelease.html" title="Multi-release contents">Multi-release contents</a></li><li><a class="doc-nav-section-link" href="../jarcreation/moduleattrs.html" title="Module attributes">Module attributes</a></li></ul>  </div>  <div class="doc-section">    <p class="section-title">Examples</p><ul><li><a class="doc-nav-section-link" href="index.html" title="Overview">Overview</a></li><li><a class="doc-nav-section-link" href="mainclass.html" title="Specifying main class">Specifying main class</a></li><li><a class="doc-nav-section-link" href="services.html" title="Adding services">Adding services</a></li><li><a class="doc-nav-section-link" href="classes.html" title="Java classes">Java classes</a></li><li class="doc-active doc-active-parent"><a class="doc-nav-section-link" href="multireleaseclasses.html" title="Multi-release Java classes">Multi-release Java classes</a></li></ul>  </div></div>
			</div>
		</div>
		<div class="col-12 col-lg-9 col-xl-10 doc-page">
			<div class="doc-breadcrumb">
				<ol itemscope itemtype="https://schema.org/BreadcrumbList"><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a itemscope itemtype="https://schema.org/WebPage" itemprop="item" href="../../index.html" title="saker.jar" itemid="/saker.jar/index.html"><span itemprop="name">saker.jar</span></a><meta itemprop="position" content="1" /></li> &rsaquo; <li><span title="Examples">Examples</span></li> &rsaquo; <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a itemscope itemtype="https://schema.org/WebPage" itemprop="item" href="multireleaseclasses.html" title="Multi-release Java classes" itemid="/saker.jar/doc/examples/multireleaseclasses.html"><span itemprop="name">Multi-release Java classes</span></a><meta itemprop="position" content="2" /></li></ol>
			</div>
			<div class="sb-sponsors" style="display: none;">
	<span class="sb-sponsors-title">Sponsors</span>
	<div class="container">
		<div class="row">
			<div class="col-md-4 col-12">
				<a class="sb-sponsors-link"></a>
			</div>
			<div class="col-md-4 col-12">
				<a class="sb-sponsors-link"></a>
			</div>
			<div class="col-md-4 col-12">
				<a class="sb-sponsors-link"></a>
			</div>
		</div>
	</div>
</div>
			<div class="doc-content"><h1 id="multi-release-java-classes">Multi-release Java classes<a class="doc-heading-anchor" href="#multi-release-java-classes"></a></h1>
<p>See also: <a href="../jarcreation/multirelease.html" title="Multi-release contents">Multi-release contents</a>, <a href="classes.html" title="Java classes">Java classes</a></p>
<p>In the following example we use the <a href="../../../saker.java.compiler/taskdoc/saker.java.compile.html"><code>saker.java.compile()</code></a> task to compile Java sources and include it in the Java archive. We'll compile the codebase for multiple target JDK versions and include them in the created JAR file. The following example uses the <a href="../../../saker.java.compiler/doc/javacompile/compileroptions.html" title="Compiler options">compiler options</a> to set an appropriate JDK for each task.</p>
<pre class="doc-code-block"><code class="language-sakerscript"><span class="c">$options</span> = <span class="b"># ... the compilation options ...</span>
<span class="c">$multireleasecontents</span> = <span class="j">foreach </span><span class="c">$jdk</span><span class="j"> in </span><span class="i">[</span><span class="e">8</span><span class="i">,</span> <span class="e">9</span><span class="i">,</span> <span class="e">10</span><span class="i">]</span><span class="j"> 
		with </span><span class="c">$javac</span> <span class="j">{</span>
	<span class="c">$javac</span> = <span class="d"><a href="../../../saker.java.compiler/taskdoc/saker.java.compile.html" title="Task: saker.java.compile()">saker.java.compile</a>(</span>
		<span class="h"><a href="../../../saker.java.compiler/taskdoc/saker.java.compile.html#SourceDirectories" title="Parameter SourceDirectories of task saker.java.compile()">SourceDirectories</a></span>: <span class="e">src</span>,
		<span class="h"><a href="../../../saker.java.compiler/taskdoc/saker.java.compile.html#Identifier" title="Parameter Identifier of task saker.java.compile()">Identifier</a></span>: <span class="e">&quot;jdk</span><span class="j">{</span> <span class="c">$jdk</span><span class="j"> }</span><span class="e">&quot;</span>,
		<span class="h"><a href="../../../saker.java.compiler/taskdoc/saker.java.compile.html#CompilerOptions" title="Parameter CompilerOptions of task saker.java.compile()">CompilerOptions</a></span>: <span class="c">$options</span>
	<span class="d">)</span>
<span class="j">}</span> <span class="j">:</span> <span class="j">{</span>
	<span class="c">$jdk</span>: <span class="i">{</span>
		<span class="g">Resources</span>: <span class="i">{</span>
			<span class="g">Directory</span>: <span class="c">$javac</span><span class="f">[</span><span class="g">ClassDirectory</span><span class="f">]</span><span class="i">,</span>
			<span class="g">Resources</span>: <span class="e">**</span>
		<span class="i">}</span>
	<span class="i">}</span>
<span class="j">}</span>
<span class="d"><a href="../../../saker.jar/taskdoc/saker.jar.create.html" title="Task: saker.jar.create()">saker.jar.create</a>(</span>
	<span class="h"><a href="../../../saker.jar/taskdoc/saker.jar.create.html#MultiReleaseContents" title="Parameter MultiReleaseContents of task saker.jar.create()">MultiReleaseContents</a></span>: <span class="c">$multireleasecontents</span>
<span class="d">)</span>
</code></pre>
<p>The JAR archive creation part of the above example simply passes the <code>MultiReleaseContents</code> parameter as its input. However, the compilation for different JDKs are more complex:</p>
<p>We use a <code>foreach</code> loop to compile the Java sources in the <code>src</code> directory for Java major versions 8, 9, and 10. The result expression of the <code>foreach</code> constructs a map that has the major versions of the target Java versions as its key, and the ZIP content specification for the value.</p>
<p>The created Java archive will have the following content structure:</p>
<pre class="doc-code-block"><code class="language-plaintext">&lt;classes for JDK8&gt;
META-INF/versions/9/&lt;classes for JDK9&gt;
META-INF/versions/10/&lt;classes for JDK10&gt;
</code></pre>
<link href="../../../css/sakerscript.css"  rel="stylesheet" type="text/css" /></div>
			<div class="end-section-links">
				<div class="end-section-prev">
					<a class="doc-prev-section" href="../../doc/examples/classes.html" title="Java classes"><svg class="doc-section-arrow" viewBox="0 0 24 24">
    <path fill="currentColor" d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" />
</svg>Java classes</a>
				</div>
				<div class="end-section-next">
					
				</div>
			</div>
			
		</div>
	</div>
</div>
<div class="doc-footer">
	<div class="container">
		<div class="row">
			<div class="footer-section col-6 col-sm-4 col-md-3">
				<p class="footer-section-title">About</p>
				<div><a href="/index.html" title="Saker.build home page">Home</a></div>
				<div data-footer-location="doc-docs"><a href="../../index.html" title="saker.jar documentation index">Documentation index</a></div>
				<div><a href="../../../saker.build/index.html" title="Information about the saker.build system">saker.build system</a></div>
				<div><a href="../../../saker.nest/index.html" title="Information about the saker.nest repository">saker.nest repository</a></div>
				<div><a href="/contact.html" title="Contact us">Contact</a></div>
			</div>
			<div class="footer-section col-6 col-sm-4 col-md-3">
				<p class="footer-section-title">Resources</p>
				<div data-footer-location="doc-docs"><a href="../../doc/index.html" title="saker.jar documentation index">Documentation</a></div>
				<div data-footer-location="doc-javadoc"><a href="../../javadoc/index.html" title="JavaDoc for saker.jar">JavaDoc</a></div>
				<div data-footer-location="doc-taskdoc"><a href="../../taskdoc/index.html"  title="Documentation of build tasks in saker.jar">TaskDoc</a></div>
				<div data-footer-location="nest-package"><a href="https://nest.saker.build/package/saker.jar" title="saker.jar | saker.nest">saker.jar on saker.nest</a></div>
				<div><a href="https://github.com/sakerbuild/saker.jar" title="saker.jar on GitHub">GitHub</a></div>
			</div>
		</div>	
		<div class="row">
			<div class="col">
			&copy; Bence Sipka 2020
			</div>
		</div>
	</div>
</div>

<link rel="stylesheet" href="../../../res/hljs.css"><script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.15.8/build/highlight.min.js" integrity="sha256-js+I1fdbke/DJrW2qXQlrw7VUEqmdeFeOW37UC0bEiU=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.13.1/build/languages/plaintext.min.js"></script>
<script>
if(window.hasOwnProperty("hljs")){
	hljs.configure({
	  languages: []
	});
	hljs.initHighlightingOnLoad();
}
</script>

</body>
</html>