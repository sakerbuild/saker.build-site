<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Precompiled headers&nbsp;|&nbsp;saker.msvc</title>
	
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"/>
	
	<link rel="stylesheet" href="../../../res/bootstrap.min.css" >
	<link rel="stylesheet" href="../../../res/doc-saker.css" >

	<script type="application/ld+json">
	{
	  "@context": "https://schema.org",
	  "@type": "WebSite",
	  "name": "saker.msvc",
	  "url": "https://saker.build/saker.msvc"
	}
	</script>
</head>
<body data-nav-location="packagedoc" data-subdoc-presence="nest-package packagedoc javadoc taskdoc">
<div class="doc-nav-bar">
	<div class="container">
		<a class="home-link" href="../../index.html" title="saker.msvc"><img style="height: 2.5em;" class="logo" src="../../../res/logo.svg"/><span class="page-name">saker.msvc</span></a>
		<a class="nav-location-item" data-nav-location="doc-docs" href="../../doc/index.html" title="Documentation">Documentation</a>
		<a class="nav-location-item" data-nav-location="doc-taskdoc" href="../../taskdoc/index.html" title="Build task documentation">TaskDoc</a>
		<a class="nav-location-item" data-nav-location="doc-javadoc" href="../../javadoc/index.html"title="Java API documentation">JavaDoc</a>
		<div class="nav-bar-controls">
			<label class="d-xl-none nav-bar-collapse" for="collapse-nav-bar-label">
				<svg style="height: 1.5em;" viewBox="0 0 24 24">
				    <path fill="currentColor" d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z" />
				</svg>
			</label>
			<input style="display:none;" id="collapse-nav-bar-label" type="checkbox"/>
			<div class="nav-bar-items">
				<a href="/" title="saker.build home page">Home</a>
				<a href="/buildtrace.html" title="Build trace viewer">Build trace</a>
				<a style="display:none;" href="/sponsor.html" title="Sponsoring development">Sponsor</a>
				<a href="/blog/" title="saker.build system blog">Blog</a>
				<a class="no-external-icon" href="https://github.com/sakerbuild/saker.build" title="saker.build GitHub repository">GitHub</a>
			</div>
		</div>
	</div>
</div>
<div class="container page-contents packagedoc">
	<div class="row">
		<div class="col-12 col-lg-3 col-xl-2 p-lg-0">
			<div class="doc-navigation-container">
				<label class="d-lg-none nav-collapse" for="doc-collapse-nav-label">
					<svg style="height: 1.5em;" viewBox="0 0 24 24">
					    <path fill="currentColor" d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z" />
					</svg>
					Navigation
				</label>
				<input style="display:none;" id="doc-collapse-nav-label" type="checkbox"/> 
				<div class="doc-nav">  <div class="doc-section"><ul><li><a class="doc-nav-section-link" href="../../index.html" title="Index">Index</a></li></ul>  </div>  <div class="doc-section">    <p class="section-title">Package details</p><ul><li><a class="doc-nav-section-link" href="../index.html" title="Overview">Overview</a></li><li><a class="doc-nav-section-link" href="../gettingstarted.html" title="Getting started">Getting started</a></li><li><a class="doc-nav-section-link" href="../performancecomparison.html" title="Performance comparison">Performance comparison</a></li></ul>  </div>  <div class="doc-section">    <p class="section-title">C/C++ compilation</p><ul><li><a class="doc-nav-section-link" href="index.html" title="Basics">Basics</a></li><li><a class="doc-nav-section-link" href="ccompilation.html" title="Compiling">Compiling</a></li><li><a class="doc-nav-section-link" href="linking.html" title="Linking">Linking</a></li><li><a class="doc-nav-section-link" href="compileroptions.html" title="Compiler options">Compiler options</a></li><li><a class="doc-nav-section-link" href="linkeroptions.html" title="Linker options">Linker options</a></li><li><a class="doc-nav-section-link" href="optionpresets.html" title="Option presets">Option presets</a></li><li><a class="doc-nav-section-link" href="sdkmanagement.html" title="SDK management">SDK management</a></li><li class="doc-active doc-active-parent"><a class="doc-nav-section-link" href="precompiledheaders.html" title="Precompiled headers">Precompiled headers</a></li><li><a class="doc-nav-section-link" href="forceinclude.html" title="Force inclusion">Force inclusion</a></li><li><a class="doc-nav-section-link" href="buildclusters.html" title="Build clusters">Build clusters</a></li></ul>  </div>  <div class="doc-section">    <p class="section-title">Examples</p><ul><li><a class="doc-nav-section-link" href="../examples/index.html" title="Overview">Overview</a></li><li><a class="doc-nav-section-link" href="../examples/helloworld.html" title="Hello world">Hello world</a></li><li><a class="doc-nav-section-link" href="../examples/hellodll.html" title="Hello DLL">Hello DLL</a></li><li><a class="doc-nav-section-link" href="../examples/simpleparameters.html" title="Passing compiler/linker parameters">Passing compiler/linker parameters</a></li><li><a class="doc-nav-section-link" href="../examples/macrodefinitions.html" title="Macro definitions">Macro definitions</a></li><li><a class="doc-nav-section-link" href="../examples/includedirectories.html" title="Include directories">Include directories</a></li><li><a class="doc-nav-section-link" href="../examples/librarypath.html" title="Library path">Library path</a></li><li><a class="doc-nav-section-link" href="../examples/architecture.html" title="Architecture">Architecture</a></li><li><a class="doc-nav-section-link" href="../examples/optionmerging.html" title="Option merging">Option merging</a></li><li><a class="doc-nav-section-link" href="../examples/optionpresets.html" title="Option presets">Option presets</a></li></ul>  </div></div>
			</div>
		</div>
		<div class="col-12 col-lg-9 col-xl-10 doc-page">
			<div class="doc-breadcrumb">
				<ol itemscope itemtype="https://schema.org/BreadcrumbList"><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a itemscope itemtype="https://schema.org/WebPage" itemprop="item" href="../../index.html" title="saker.msvc" itemid="/saker.msvc/index.md"><span itemprop="name">saker.msvc</span></a><meta itemprop="position" content="1" /></li> &rsaquo; <li><span title="C/C++ compilation">C/C++ compilation</span></li> &rsaquo; <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a itemscope itemtype="https://schema.org/WebPage" itemprop="item" href="precompiledheaders.html" title="Precompiled headers" itemid="/saker.msvc/doc/ccompile/precompiledheaders.md"><span itemprop="name">Precompiled headers</span></a><meta itemprop="position" content="2" /></li></ol>
			</div>
			<div class="sb-sponsors" style="display: none;">
	<span class="sb-sponsors-title">Sponsors</span>
	<div class="container">
		<div class="row">
			<div class="col-md-4 col-12">
				<a class="sb-sponsors-link"></a>
			</div>
			<div class="col-md-4 col-12">
				<a class="sb-sponsors-link"></a>
			</div>
			<div class="col-md-4 col-12">
				<a class="sb-sponsors-link"></a>
			</div>
		</div>
	</div>
</div>
			<div class="doc-content"><h1 id="precompiled-headers">Precompiled headers<a class="doc-heading-anchor" href="#precompiled-headers"></a></h1>
<p>The <a href="../../taskdoc/saker.msvc.ccompile.html"><code>saker.msvc.ccompile()</code></a> task supports using precompiled headers during compilation. Precompiled headers can improve build times by precompiling infrequently changing header files and reusing them later. See more information on the <a href="https://docs.microsoft.com/en-us/cpp/build/creating-precompiled-header-files?view=vs-2019" title="Precompiled Header Files | Microsoft Docs">Precompiled Header Files | Microsoft Docs</a> site for an in-depth explanation.</p>
<p>In order to use precompiled headers, you need to specify the <code>PrecompiledHeader</code> parameter for the source files in your build task invocation:</p>
<pre class="doc-code-block"><code class="language-sakerscript"><span class="d"><a href="../../../saker.msvc/taskdoc/saker.msvc.ccompile.html" title="Task: saker.msvc.ccompile()">saker.msvc.ccompile</a>(</span><span class="i">{</span>
	<span class="g">Files</span>: <span class="e">src/*.cpp</span><span class="i">,</span>
	<span class="g">PrecompiledHeader</span>: <span class="e">pch/pch.h</span><span class="i">,</span>
<span class="i">}</span><span class="d">)</span>
</code></pre>
<p>The above will result in the <code>pch/pch.h</code> header being precompiled before any of the <code>cpp</code> files, and it can be used in the source files themselves. The precompiled header can be included in your source files with the <code>#include &quot;pch.h&quot;</code> line as the first line of the source code. The expected for the <code>#include</code> statement is the same as the file name of the precompiled header:</p>
<pre class="doc-code-block"><code class="language-cpp">#include &quot;pch.h&quot;

int main() {
	return 0;
}
</code></pre>
<p>If you have multiple source files, the precompiled header will be compiled only once by the build task and reused for inclusion in multiple source files. It is recommended that frequently used header files are added to the precompiled header, as this can improve compilation times.</p>
<p>The build task also supports using precompiled headers on multiple machines. That is, if you use build clusters to distribute the compilation tasks, the precompiled headers are used on the clusters as well. (See <a href="precompiledheaders.html#notes" title="Notes">Notes</a> for more information.)</p>
<h2 id="force-inclusion">Force inclusion<a class="doc-heading-anchor" href="#force-inclusion"></a></h2>
<p>As you've seen, in order to use the precompiled header, you need to include it in the first statement of the compiled source files. If you don't include it, the compiler will throw an error.</p>
<p>As it may feel like a chore, you can specify the <a href="../../taskdoc/types/CompilationInputPassTaskOption.html#f-ForceIncludePrecompiledHeader"><code>ForceIncludePrecompiledHeader</code></a> parameter to have that done automatically for your. If you set it to <code>true</code>, the build task will automatically add an appropriate <a href="https://docs.microsoft.com/en-us/cpp/build/reference/fi-name-forced-include-file?view=vs-2019" title="/FI (Name Forced Include File) | Microsoft Docs"><code>/FI</code></a> command line argument to force include the precompiled header.</p>
<p><strong>Note</strong> that we don't recommend using this as it may cause portability issues to other build system.</p>
<h2 id="notes">Notes<a class="doc-heading-anchor" href="#notes"></a></h2>
<p>Using precompiled headers may differ from the experience you're used to in Visual Studio.</p>
<p>First of all, you don't need a separate <code>cpp</code> or other compilation unit file for your precompiled header. The task will compile the precompiled header file as is. This means that the actual input to the compiler is the <code>pch.h</code> instead of constructing a new compilation unit. (I.e. you don't need <code>stdafx.cpp</code> or other files.)</p>
<p>When using build clusters and precompiled headers, you should know that the precompiled header objects will not be shared between build machines. The precompilation will be done on all build clusters that are asked to execute a compilation. This is because the compiler limits the usage of the precompiled header objects to a single machine, and they cannot be reliably shared between build machines. See <a href="https://docs.microsoft.com/en-us/cpp/build/reference/yu-use-precompiled-header-file?view=vs-2019" title="/Yu (Use Precompiled Header File) | Microsoft Docs"><code>/Yu</code></a> option.</p>
<p>The precompiled header object files are reused between builds if their inputs haven't changed. This caching is also performed on the build clusters, so you generally don't need to worry about the precompilation being done on all clusters. Incremental builds won't suffer from this drawback.</p>
<p>If you <a href="forceinclude.html" title="Force inclusion">force include</a> other files in your compilation, those inclusions will be present <strong>before</strong> the precompiled header. The force included files will be part of the precompiled header.</p>
<link href="../../../css/sakerscript.css"  rel="stylesheet" type="text/css" /></div>
			<div class="end-section-links">
				<div class="end-section-prev">
					<a class="doc-prev-section" href="../../doc/ccompile/sdkmanagement.html" title="SDK management"><svg class="doc-section-arrow" viewBox="0 0 24 24">
    <path fill="currentColor" d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" />
</svg>SDK management</a>
				</div>
				<div class="end-section-next">
					<a class="doc-next-section" href="../../doc/ccompile/forceinclude.html" title="Force inclusion">Force inclusion<svg class="doc-section-arrow" viewBox="0 0 24 24">
    <path fill="currentColor" d="M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z" />
</svg></a>
				</div>
			</div>
			<div class="doc-headings-nav">  <ul>    <li><a href="#precompiled-headers" title="Precompiled headers">Precompiled headers</a>      <ul>        <li><a href="#force-inclusion" title="Force inclusion">Force inclusion</a>        </li>        <li><a href="#notes" title="Notes">Notes</a>        </li>      </ul>    </li>  </ul></div>
		</div>
	</div>
</div>
<div class="doc-footer">
	<div class="container">
		<div class="row">
			<div class="footer-section col-6 col-sm-4 col-md-3">
				<p class="footer-section-title">About</p>
				<div><a href="/index.html" title="Saker.build home page">Home</a></div>
				<div data-footer-location="doc-docs"><a href="../../index.html" title="saker.msvc documentation index">Documentation index</a></div>
				<div><a href="../../../saker.build/index.html" title="Information about the saker.build system">saker.build system</a></div>
				<div><a href="../../../saker.nest/index.html" title="Information about the saker.nest repository">saker.nest repository</a></div>
				<div><a href="/contact.html" title="Contact us">Contact</a></div>
			</div>
			<div class="footer-section col-6 col-sm-4 col-md-3">
				<p class="footer-section-title">Resources</p>
				<div data-footer-location="doc-docs"><a href="../../doc/index.html" title="saker.msvc documentation index">Documentation</a></div>
				<div data-footer-location="doc-javadoc"><a href="../../javadoc/index.html" title="JavaDoc for saker.msvc">JavaDoc</a></div>
				<div data-footer-location="doc-taskdoc"><a href="../../taskdoc/index.html"  title="Documentation of build tasks in saker.msvc">TaskDoc</a></div>
				<div data-footer-location="nest-package"><a href="https://nest.saker.build/package/saker.msvc" title="saker.msvc | saker.nest">saker.msvc on saker.nest</a></div>
				<div><a href="https://github.com/sakerbuild/saker.msvc" title="saker.msvc on GitHub">GitHub</a></div>
			</div>
		</div>	
		<div class="row">
			<div class="col">
			&copy; Bence Sipka 2020
			</div>
		</div>
	</div>
</div>

<link rel="stylesheet" href="../../../res/hljs.css"><script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.15.8/build/highlight.min.js" integrity="sha256-js+I1fdbke/DJrW2qXQlrw7VUEqmdeFeOW37UC0bEiU=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.13.1/build/languages/cpp.min.js"></script>
<script>
if(window.hasOwnProperty("hljs")){
	hljs.configure({
	  languages: []
	});
	hljs.initHighlightingOnLoad();
}
</script>

</body>
</html>