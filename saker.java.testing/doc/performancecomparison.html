<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Performance comparison&nbsp;|&nbsp;saker.java.testing</title>
	
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"/>
	
	<link rel="stylesheet" href="../../res/bootstrap.min.css" >
	<link rel="stylesheet" href="../../res/doc-saker.css" >

	<script type="application/ld+json">
	{
	  "@context": "https://schema.org",
	  "@type": "WebSite",
	  "name": "saker.java.testing",
	  "url": "https://saker.build/saker.java.testing"
	}
	</script>
</head>
<body data-nav-location="packagedoc" data-subdoc-presence="nest-package packagedoc javadoc taskdoc">
<div class="doc-nav-bar">
	<div class="container">
		<a class="home-link" href="../index.html" title="saker.java.testing"><img style="height: 2.5em;" class="logo" src="../../res/logo.svg"/><span class="page-name">saker.java.testing</span></a>
		<a class="nav-location-item" data-nav-location="doc-docs" href="../doc/index.html" title="Documentation">Documentation</a>
		<a class="nav-location-item" data-nav-location="doc-taskdoc" href="../taskdoc/index.html" title="Build task documentation">TaskDoc</a>
		<a class="nav-location-item" data-nav-location="doc-javadoc" href="../javadoc/index.html"title="Java API documentation">JavaDoc</a>
		<span class="nav-hover-packages-item"><span class="nav-hover-packages-span" onclick="return false;">Packages</span><div class="nav-hover-packages">
<ul>
<li><a href="/nest.repository.support/doc/index.html">nest.repository.support</a></li>
<li><a href="/saker.android/doc/index.html">saker.android</a></li>
<li><a href="/saker.build/doc/index.html">saker.build</a></li>
<li><a href="/saker.compiler.utils/doc/index.html">saker.compiler.utils</a></li>
<li><a href="/saker.jar/doc/index.html">saker.jar</a></li>
<li><a href="/saker.java.compiler/doc/index.html">saker.java.compiler</a></li>
<li><a href="/saker.java.testing/doc/index.html">saker.java.testing</a></li>
<li><a href="/saker.maven.classpath/doc/index.html">saker.maven.classpath</a></li>
<li><a href="/saker.maven.support/doc/index.html">saker.maven.support</a></li>
<li><a href="/saker.msvc/doc/index.html">saker.msvc</a></li>
<li><a href="/saker.nest/doc/index.html">saker.nest</a></li>
<li><a href="/saker.rmi/doc/index.html">saker.rmi</a></li>
<li><a href="/saker.sdk.support/doc/index.html">saker.sdk.support</a></li>
<li><a href="/saker.standard/doc/index.html">saker.standard</a></li>
<li><a href="/saker.util/doc/index.html">saker.util</a></li>
<li><a href="/saker.zip/doc/index.html">saker.zip</a></li>
</ul>
</div></span>
		<div class="nav-bar-controls">
			<label class="d-xl-none nav-bar-collapse" for="collapse-nav-bar-label">
				<svg style="height: 1.5em;" viewBox="0 0 24 24">
				    <path fill="currentColor" d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z" />
				</svg>
			</label>
			<input style="display:none;" id="collapse-nav-bar-label" type="checkbox"/>
			<div class="nav-bar-items">
				<a href="/" title="saker.build home page">Home</a>
				<a href="/buildtrace.html" title="Build trace viewer">Build trace</a>
				<a style="display:none;" href="/sponsor.html" title="Sponsoring development">Sponsor</a>
				<a href="/blog/" title="saker.build system blog">Blog</a>
				<a class="no-external-icon" href="https://github.com/sakerbuild/saker.build" title="saker.build GitHub repository">GitHub</a>
			</div>
		</div>
	</div>
</div>
<div class="container page-contents packagedoc">
	<div class="row">
		<div class="col-12 col-lg-3 col-xl-2 p-lg-0">
			<div class="doc-navigation-container">
				<label class="d-lg-none nav-collapse" for="doc-collapse-nav-label">
					<svg style="height: 1.5em;" viewBox="0 0 24 24">
					    <path fill="currentColor" d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z" />
					</svg>
					Navigation
				</label>
				<input style="display:none;" id="doc-collapse-nav-label" type="checkbox"/> 
				<div class="doc-nav">  <div class="doc-section"><ul><li><a class="doc-nav-section-link" href="../index.html" title="Index">Index</a></li></ul>  </div>  <div class="doc-section">    <p class="section-title">Package details</p><ul><li><a class="doc-nav-section-link" href="index.html" title="Overview">Overview</a></li><li><a class="doc-nav-section-link" href="gettingstarted.html" title="Getting started">Getting started</a></li><li class="doc-active doc-active-parent"><a class="doc-nav-section-link" href="performancecomparison.html" title="Performance comparison">Performance comparison</a></li></ul>  </div>  <div class="doc-section">    <p class="section-title">Testing</p><ul><li><a class="doc-nav-section-link" href="testing/index.html" title="Overview">Overview</a></li><li><a class="doc-nav-section-link" href="testing/classpath.html" title="Test classpath">Test classpath</a></li><li><a class="doc-nav-section-link" href="testing/testinvocation.html" title="Test invocation">Test invocation</a></li><li><a class="doc-nav-section-link" href="testing/testparameters.html" title="Test parameters">Test parameters</a></li></ul>  </div>  <div class="doc-section">    <p class="section-title">Examples</p><ul><li><a class="doc-nav-section-link" href="examples/index.html" title="Overview">Overview</a></li><li><a class="doc-nav-section-link" href="examples/junit.html" title="Using JUnit">Using JUnit</a></li></ul>  </div></div>
			</div>
		</div>
		<div class="col-12 col-lg-9 col-xl-10 doc-page">
			<div class="doc-breadcrumb">
				<ol itemscope itemtype="https://schema.org/BreadcrumbList"><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a itemscope itemtype="https://schema.org/WebPage" itemprop="item" href="../index.html" title="saker.java.testing" itemid="/saker.java.testing/index.html"><span itemprop="name">saker.java.testing</span></a><meta itemprop="position" content="1" /></li> &rsaquo; <li><span title="Package details">Package details</span></li> &rsaquo; <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a itemscope itemtype="https://schema.org/WebPage" itemprop="item" href="performancecomparison.html" title="Performance comparison" itemid="/saker.java.testing/doc/performancecomparison.html"><span itemprop="name">Performance comparison</span></a><meta itemprop="position" content="2" /></li></ol>
			</div>
			<div class="sb-sponsors" style="display: none;">
	<span class="sb-sponsors-title">Sponsors</span>
	<div class="container">
		<div class="row">
			<div class="col-md-4 col-12">
				<a class="sb-sponsors-link"></a>
			</div>
			<div class="col-md-4 col-12">
				<a class="sb-sponsors-link"></a>
			</div>
			<div class="col-md-4 col-12">
				<a class="sb-sponsors-link"></a>
			</div>
		</div>
	</div>
</div>
			<div class="doc-content"><h1 id="performance-comparison">Performance comparison<a class="doc-heading-anchor" href="#performance-comparison"></a></h1>
<p>In this article, we'll be showing the results of performance measurements including Java testing. We'll be comparing the testing performance of the saker.java.testing package against the <a href="https://gradle.org/" title="Gradle Build Tool">Gradle</a> build tool.<noscript> (Enabling JavaScript will convert the below measurement tables to bar graphs.)</noscript></p>
<p>If you're intereseted in Java compilation performance, see <a href="../../saker.java.compiler/doc/performancecomparison.html" title="Performance comparison">here</a>.</p>
<p>All the comparisons are done on the same and single machine. The comparions are done on Windows 10, with the Windows Defender being turned off all times. When doing the comparisons, we'll be using the build daemons of each participating tool when applicable.</p>
<p>During the measurements, we'll be doing some warm-up round(s) for each tools which won't be part of the result. Then we compute the average of the measured times and that will be the result of a measurement. We don't use any benchmarking/profiling tools, and don't set any options that instrument the tools for benchmarking.</p>
<p>We'll use the <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/measure-command?view=powershell-6" title="Measure-Command"><code>Measure-Command</code></a> PowerShell cmdlet to measure the time it takes to execute a build. (We use the time the cmdlet displays instead that the given tool displays to have a consistent measuring practice.) Note that when the tools are used inside an IDE, the startup cost of the Java processes may be omitted.</p>
<p>When clean builds are measured, the previous outputs are manually cleaned from the output directory rather than running <code>clean</code> commands for a given tool.</p>
<h2 id="large-monolithic-project">Large monolithic project<a class="doc-heading-anchor" href="#large-monolithic-project"></a></h2>
<p>We measure the testing performance on the <a href="https://github.com/gradle/performance-comparisons/tree/13739fa299e485c079335b0cd5b30da1cff92234/single-large-project" title="performance-comparisons/single-large-project at 13739fa299e485c079335b0cd5b30da1cff92234 &#183; gradle/performance-comparisons &#183; GitHub">single-large-project</a> that is published by Gradle specifically for performance comparisons. It contains 50000 source files and 50000 associated test cases.</p>
<p>We've modified the project a little bit, in order to make the comparison fairer. We disabled report generation for Gradle, and increased the number of JVM forks for testing to match the settings we use for saker.build. The following was set for the <code>build.gradle</code> file:</p>
<pre class="doc-code-block"><code class="language-groovy">test {
    reports {
        junitXml.enabled = false
		html.enabled = false
    }
	maxParallelForks = 4
}
</code></pre>
<p>Let's see the results:</p>
<div id="perf-large-monolithic-test" style="--doc-metric:' ms';" class="doc-bar-graph" doc-label-y="duration">
<div class="doc-bar-graph-title">Large monolithic project compile + test</div>
<table>
<thead>
<tr><th>Test case</th><th align="right">Saker.build</th><th align="right">Gradle 6.0.1</th></tr>
</thead>
<tbody>
<tr><td>Clean compile + test</td><td align="right">108245</td><td align="right">193096</td></tr>
<tr><td>No-op (no-changes)</td><td align="right">762</td><td align="right">5799</td></tr>
<tr><td>Incremental test class change</td><td align="right">2934</td><td align="right">36384</td></tr>
<tr><td>Incremental source class change</td><td align="right">3298</td><td align="right">35097</td></tr>
</tbody>
</table>
</div>
<p>Based on the results we can see that clean compilation and testing is performed <strong>44%</strong> by saker.build. In case of incremental changes, the performance increase is around <strong>90%</strong>! We can clearly see an advantage of the <a href="../taskdoc/saker.java.test.html"><code>saker.java.test()</code></a> task in that it tracks the dependencies of each invoked test case. In the incremental scenarios, it only needed to reinvoke the modified test case instead of invoking all 50000 of them.</p>
<div class="doc-wip">
<p>This article is work in progress. In the future we'd like to add comparisons for other, more realistic projects. We'd also like to employ some more performance optimizations in the Java testing build task, and also compare the testing performance if there are no dependency instrumentation for the test cases.</p>
</div>
<p><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.7.3/c3.min.css" integrity="sha256-RSMIOX07BNUXyf71hwmYRrUZ8RmiBxMTpqI0GOAy0GM=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.9.7/d3.min.js" integrity="sha256-D+2/goqcjnuoryb9A0rifuH0rBYS9hKOzNqG91JhAVc=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.7.3/c3.min.js" integrity="sha256-SyrzeJ/tU+9ZJk4n351h9iJftMf9VdsEx2QQMx8+Pik=" crossorigin="anonymous"></script>
<script>
(function(){
	let colors = {
		'saker': '#1da9d8',
		'saker.build ide': '#208bc3',
		'saker.build + cluster': '#208bc3',
		'gradle': '#175643',
		'ninja': '#444444',
		'incredibuild': '#8c114e'
	};
	function groupedNumber(x) {
		if(x == null) {
			return null;
		}
	  	return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, " ");
	}
	function createChart(targetid, title, data, metric, color, ylabel, grouping) {
	console.log(grouping);
		c3.generate({
			bindto: targetid,
			data: {
				rows: data,
				type: 'bar',
				x: data[0][0],
				labels: {
					format: function(v, id, i, j) { return v == null ? null : (groupedNumber(v) + metric); }
				},
				order: null,
				groups: grouping
			},
			axis: {
				x: {
					type: 'category'
				},
				y: {
					label: `${ylabel} (${metric})`,
					tick: {
						format: function(v, id, i, j) { return groupedNumber(v); }
					}
				}
			},
			legend: {
				position: 'bottom'
			},
			padding: {
	            bottom: 10
	        },
			title: {
				text: title
			},
			color: {
				pattern: color
			},
			tooltip: {
				format: {
					value: function (value, ratio, id, index) { return value == null ? null : (groupedNumber(value) + metric); }
				}
			}
		});
	}

	let graphdivs = document.querySelectorAll('div.doc-bar-graph');
	graphdivs.forEach(function(gdiv) {
		let tableinfo = Array.prototype.map.call(gdiv.querySelectorAll('tr'), function(tr){
			return Array.prototype.map.call(tr.querySelectorAll('td,th'), function(td){
				let ih = td.innerHTML;
		    	return ih == "" ? null : ih;
			});
		});
		let colorspattern = [];
		for(let i = 1; i < tableinfo[0].length; i++) {
			let c = colors[tableinfo[0][i].toLowerCase()];
			if(c != null) {
				colorspattern.push(c);
			} else {
				let id = tableinfo[0][i].match(/[A-Za-z]+/)[0].toLowerCase();
				colorspattern.push(colors[id]);
			}
		}
		let grouping = gdiv.getAttribute('doc-grouping');
		let graphtitle = gdiv.querySelector('.doc-bar-graph-title');
		createChart(
			'#' + gdiv.id, 
			graphtitle == null ? null : graphtitle.textContent, 
			tableinfo, 
			window.getComputedStyle(gdiv).getPropertyValue('--doc-metric').slice(1, -1), 
			colorspattern, 
			gdiv.getAttribute('doc-label-y'),
			grouping == null ? undefined : JSON.parse(grouping)
		);
	});
}());
</script></p>
<link href="../../css/sakerscript.css"  rel="stylesheet" type="text/css" /></div>
			<div class="end-section-links">
				<div class="end-section-prev">
					<a class="doc-prev-section" href="../doc/gettingstarted.html" title="Getting started"><svg class="doc-section-arrow" viewBox="0 0 24 24">
    <path fill="currentColor" d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" />
</svg>Getting started</a>
				</div>
				<div class="end-section-next">
					<a class="doc-next-section" href="../doc/testing/index.html" title="Overview">Overview<svg class="doc-section-arrow" viewBox="0 0 24 24">
    <path fill="currentColor" d="M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z" />
</svg></a>
				</div>
			</div>
			<div class="doc-headings-nav">  <ul>    <li><a href="#performance-comparison" title="Performance comparison">Performance comparison</a>      <ul>        <li><a href="#large-monolithic-project" title="Large monolithic project">Large monolithic project</a>        </li>      </ul>    </li>  </ul></div>
		</div>
	</div>
</div>
<div class="doc-footer">
	<div class="container">
		<div class="row">
			<div class="footer-section col-6 col-sm-4 col-md-3">
				<p class="footer-section-title">About</p>
				<div><a href="/index.html" title="Saker.build home page">Home</a></div>
				<div data-footer-location="doc-docs"><a href="../index.html" title="saker.java.testing documentation index">Documentation index</a></div>
				<div><a href="../../saker.build/index.html" title="Information about the saker.build system">saker.build system</a></div>
				<div><a href="../../saker.nest/index.html" title="Information about the saker.nest repository">saker.nest repository</a></div>
				<div><a href="/contact.html" title="Contact us">Contact</a></div>
			</div>
			<div class="footer-section col-6 col-sm-4 col-md-3">
				<p class="footer-section-title">Resources</p>
				<div data-footer-location="doc-docs"><a href="../doc/index.html" title="saker.java.testing documentation index">Documentation</a></div>
				<div data-footer-location="doc-javadoc"><a href="../javadoc/index.html" title="JavaDoc for saker.java.testing">JavaDoc</a></div>
				<div data-footer-location="doc-taskdoc"><a href="../taskdoc/index.html"  title="Documentation of build tasks in saker.java.testing">TaskDoc</a></div>
				<div data-footer-location="nest-package"><a href="https://nest.saker.build/package/saker.java.testing" title="saker.java.testing | saker.nest">saker.java.testing on saker.nest</a></div>
				<div><a href="https://github.com/sakerbuild/saker.java.testing" title="saker.java.testing on GitHub">GitHub</a></div>
			</div>
		</div>	
		<div class="row">
			<div class="col">
			&copy; Bence Sipka 2020
			</div>
		</div>
	</div>
</div>

<link rel="stylesheet" href="../../res/hljs.css"><script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.15.8/build/highlight.min.js" integrity="sha256-js+I1fdbke/DJrW2qXQlrw7VUEqmdeFeOW37UC0bEiU=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.13.1/build/languages/groovy.min.js"></script>
<script>
if(window.hasOwnProperty("hljs")){
	hljs.configure({
	  languages: []
	});
	hljs.initHighlightingOnLoad();
}
</script>

</body>
</html>