<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Immutable collections&nbsp;|&nbsp;saker.util</title>
	
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"/>
	
	<link rel="stylesheet" href="../../../res/bootstrap.min.css" >
	<link rel="stylesheet" href="../../../res/doc-saker.css" >
</head>
<body data-nav-location="packagedoc" data-subdoc-presence="nest-package packagedoc javadoc">
<div class="doc-nav-bar">
	<div class="container">
		<a class="home-link" href="../../index.html" title="saker.util"><img style="height: 2.5em;" class="logo" src="../../../res/logo.svg"/><span class="page-name">saker.util</span></a>
		<a class="nav-location-item" data-nav-location="doc-docs" href="../../doc/index.html" title="Documentation">Documentation</a>
		<a class="nav-location-item" data-nav-location="doc-taskdoc" href="../../taskdoc/index.html" title="Build task documentation">TaskDoc</a>
		<a class="nav-location-item" data-nav-location="doc-javadoc" href="../../javadoc/index.html"title="Java API documentation">JavaDoc</a>
		<div class="nav-bar-controls">
			<label class="d-xl-none nav-bar-collapse" for="collapse-nav-bar-label">
				<svg style="height: 1.5em;" viewBox="0 0 24 24">
				    <path fill="currentColor" d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z" />
				</svg>
			</label>
			<input style="display:none;" id="collapse-nav-bar-label" type="checkbox"/>
			<div class="nav-bar-items">
				<a href="/" title="saker.build home page">Home</a>
				<a href="/buildtrace.html" title="Build trace viewer">Build trace</a>
				<a style="display:none;" href="/sponsor.html" title="Sponsoring development">Sponsor</a>
				<a href="/blog/" title="saker.build system blog">Blog</a>
				<a class="no-external-icon" href="https://github.com/sakerbuild/saker.build" title="saker.build GitHub repository">GitHub</a>
			</div>
		</div>
	</div>
</div>
<div class="container page-contents packagedoc">
	<div class="row">
		<div class="col-12 col-lg-3 col-xl-2 p-lg-0">
			<div class="doc-navigation-container">
				<label class="d-lg-none nav-collapse" for="doc-collapse-nav-label">
					<svg style="height: 1.5em;" viewBox="0 0 24 24">
					    <path fill="currentColor" d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z" />
					</svg>
					Navigation
				</label>
				<input style="display:none;" id="doc-collapse-nav-label" type="checkbox"/> 
				<div class="doc-nav">  <div class="doc-section"><ul><li><a class="doc-nav-section-link" href="../../index.html" title="Index">Index</a></li></ul>  </div>  <div class="doc-section">    <p class="section-title">Package details</p><ul><li><a class="doc-nav-section-link" href="../index.html" title="Overview">Overview</a></li><li><label class="doc-nav-collapse" for="_doc_collapse_id_0"><a class="doc-nav-section-link" href="../gettingstarted.html" title="Getting started">Getting started</a></label><input style="display:none;" id="_doc_collapse_id_0" type="checkbox"/><label class="doc-nav-section-arrow" for="_doc_collapse_id_0"></label><ul><li><a class="doc-nav-section-link" href="../addclasspath.html" title="Classpath">Classpath</a></li><li><a class="doc-nav-section-link" href="../downloadlib.html" title="Download the library">Download the library</a></li><li><a class="doc-nav-section-link" href="../asbundledependency.html" title="As bundle dependency">As bundle dependency</a></li></ul></li></ul>  </div>  <div class="doc-section">    <p class="section-title">Features</p><ul><li><a class="doc-nav-section-link" href="index.html" title="Feature overview">Feature overview</a></li><li class="doc-active doc-active-parent"><a class="doc-nav-section-link" href="immutableutils.html" title="Immutable collections">Immutable collections</a></li><li><a class="doc-nav-section-link" href="streamutils.html" title="Stream utilities">Stream utilities</a></li><li><a class="doc-nav-section-link" href="serialutils.html" title="Serialization utilities">Serialization utilities</a></li><li><a class="doc-nav-section-link" href="resclosing.html" title="Resource closing">Resource closing</a></li><li><a class="doc-nav-section-link" href="sortediteration.html" title="Sorted iteration">Sorted iteration</a></li><li><a class="doc-nav-section-link" href="unsyncstreams.html" title="Non-synchronized streams">Non-synchronized streams</a></li><li><a class="doc-nav-section-link" href="classloaderutils.html" title="ClassLoader utilities">ClassLoader utilities</a></li><li><a class="doc-nav-section-link" href="threadutils.html" title="Thread utilities">Thread utilities</a></li></ul>  </div></div>
			</div>
		</div>
		<div class="col-12 col-lg-9 col-xl-10 doc-page">
			<div class="doc-breadcrumb">
				Features > <a href="immutableutils.html" title="Immutable collections">Immutable collections</a>
			</div>
			<div class="sb-sponsors" style="display: none;">
	<span class="sb-sponsors-title">Sponsors</span>
	<div class="container">
		<div class="row">
			<div class="col-md-4 col-12">
				<a class="sb-sponsors-link"></a>
			</div>
			<div class="col-md-4 col-12">
				<a class="sb-sponsors-link"></a>
			</div>
			<div class="col-md-4 col-12">
				<a class="sb-sponsors-link"></a>
			</div>
		</div>
	</div>
</div>
			<div class="doc-content"><h1 id="immutable-collections">Immutable collections<a class="doc-heading-anchor" href="#immutable-collections"></a></h1>
<p>The <a href="../../javadoc/saker/util/ImmutableUtils.html"><code>ImmutableUtils</code></a> class provides functionality for working with and creating immutable collections and maps. From our perspective, one of the main advantage of using immutable collections (apart from being immutable of course) is that they can be significantly more memory efficient.</p>
<p>Using an immutable <a href="https://docs.oracle.com/javase/8/docs/api/java/util/NavigableSet.html" title="NavigableSet (Java Platform SE 8 )"><code>NavigableSet</code></a> instead of a <a href="https://docs.oracle.com/javase/8/docs/api/java/util/TreeSet.html" title="TreeSet (Java Platform SE 8 )"><code>TreeSet</code></a> or <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ConcurrentSkipListSet.html" title="ConcurrentSkipListSet (Java Platform SE 8 )"><code>ConcurrentSkipListSet</code></a> can result in significantly fewer objects in memory, and overall less memory usage. Given that those implementations are backed by <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.html" title="Map (Java Platform SE 8 )"><code>Map</code></a> instances, they will need to have a <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.Entry.html" title="Map.Entry (Java Platform SE 8 )"><code>Map.Entry</code></a> object allocated for each contained element. However, an immutable navigable set implementation can use a simple backing array, that uses less memory, while provides the same O(log n) algorithmic complexity. Being backed by an array can also provide better memory performance as the element references are closer in memory.</p>
<p>We've experienced that when dealing with lot of collections and lot of elements, using the immutable collections can noticeably the memory usage.</p>
<h4 id="externalization">Externalization<a class="doc-heading-anchor" href="#externalization"></a></h4>
<p>In our use-cases, we needed the collections to be <a href="https://docs.oracle.com/javase/8/docs/api/java/io/Externalizable.html" title="Externalizable (Java Platform SE 8 )"><code>Externalizable</code></a> in order to implement a more error-tolerant serialization. The immutable collections that the class provides all implement the <a href="https://docs.oracle.com/javase/8/docs/api/java/io/Externalizable.html" title="Externalizable (Java Platform SE 8 )"><code>Externalizable</code></a> interface, unless it is explicitly noted otherwise.</p>
<h4 id="singletions_-empties">Singletions, empties<a class="doc-heading-anchor" href="#singletions_-empties"></a></h4>
<p>The class also provides functions for singleton and empty collections additionally to the ones provided by <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Collections.html" title="Collections (Java Platform SE 8 )"><code>Collections</code></a>. Among others, it allows creating sorted singleton maps, and empty sorted sets/maps that return a given comparator.</p>
<p>When you're creating lot of singleton lists, it may be important that our <a href="../../javadoc/saker/util/ImmutableUtils.html#singletonList-E-">singleton list</a> implementation doesn't extend <a href="https://docs.oracle.com/javase/8/docs/api/java/util/AbstractList.html" title="AbstractList (Java Platform SE 8 )"><code>AbstractList</code></a> therefore not including the unnecessary 4 byte field <a href="https://docs.oracle.com/javase/8/docs/api/java/util/AbstractList.html#modCount" title="AbstractList (Java Platform SE 8 )"><code>modCount</code></a> (neither does our other immutable lists). (In case of large number of singleton lists, the 4 bytes may add up.)</p>
<link href="../../../css/sakerscript.css"  rel="stylesheet" type="text/css" /></div>
			<div class="end-section-links">
				<div class="end-section-prev">
					<a class="doc-prev-section" href="../../doc/features/index.html" title="Feature overview"><svg class="doc-section-arrow" viewBox="0 0 24 24">
    <path fill="currentColor" d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" />
</svg>Feature overview</a>
				</div>
				<div class="end-section-next">
					<a class="doc-next-section" href="../../doc/features/streamutils.html" title="Stream utilities">Stream utilities<svg class="doc-section-arrow" viewBox="0 0 24 24">
    <path fill="currentColor" d="M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z" />
</svg></a>
				</div>
			</div>
			<div class="doc-headings-nav">  <ul>    <li><a href="#immutable-collections" title="Immutable collections">Immutable collections</a>      <ul>        <li><a href="#externalization" title="Externalization">Externalization</a>        </li>        <li><a href="#singletions_-empties" title="Singletions, empties">Singletions, empties</a>        </li>      </ul>    </li>  </ul></div>
		</div>
	</div>
</div>
<div class="doc-footer">
	<div class="container">
		<div class="row">
			<div class="footer-section col-6 col-sm-4 col-md-3">
				<p class="footer-section-title">About</p>
				<div><a href="/index.html" title="Saker.build home page">Home</a></div>
				<div data-footer-location="doc-docs"><a href="../../index.html" title="saker.util documentation index">Documentation index</a></div>
				<div><a href="../../../saker.build/index.html" title="Information about the saker.build system">saker.build system</a></div>
				<div><a href="../../../saker.nest/index.html" title="Information about the saker.nest repository">saker.nest repository</a></div>
				<div><a href="/contact.html" title="Contact us">Contact</a></div>
			</div>
			<div class="footer-section col-6 col-sm-4 col-md-3">
				<p class="footer-section-title">Resources</p>
				<div data-footer-location="doc-docs"><a href="../../doc/index.html" title="saker.util documentation index">Documentation</a></div>
				<div data-footer-location="doc-javadoc"><a href="../../javadoc/index.html" title="JavaDoc for saker.util">JavaDoc</a></div>
				<div data-footer-location="doc-taskdoc"><a href="../../taskdoc/index.html"  title="Documentation of build tasks in saker.util">TaskDoc</a></div>
				<div data-footer-location="nest-package"><a href="https://nest.saker.build/package/saker.util" title="saker.util | saker.nest">saker.util on saker.nest</a></div>
				<div><a href="https://github.com/sakerbuild/saker.util" title="saker.util on GitHub">GitHub</a></div>
			</div>
		</div>	
		<div class="row">
			<div class="col">
			&copy; Bence Sipka 2020
			</div>
		</div>
	</div>
</div>


<script>
if(window.hasOwnProperty("hljs")){
	hljs.configure({
	  languages: []
	});
	hljs.initHighlightingOnLoad();
}
</script>

</body>
</html>