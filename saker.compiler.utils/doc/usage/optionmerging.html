<!DOCTYPE html>
<html>
<head>
	<title>Compiler option merging&nbsp;|&nbsp;saker.compiler.utils</title>
	
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"/>
	
	<link rel="stylesheet" href="../../../res/bootstrap.min.css" >
	<link rel="stylesheet" href="../../../res/doc-saker.css" >
</head>
<body data-nav-location="packagedoc" data-subdoc-presence="nest-package packagedoc javadoc">
<div class="doc-nav-bar">
	<div class="container">
		<a class="home-link" href="../../index.html" title="saker.compiler.utils"><img style="height: 2.5em;" class="logo" src="../../../res/logo.svg"/><span class="page-name">saker.compiler.utils</span></a>
		<a class="nav-location-item" data-nav-location="doc-docs" href="../../doc/index.html" title="Documentation">Documentation</a>
		<a class="nav-location-item" data-nav-location="doc-taskdoc" href="../../taskdoc/index.html" title="Build task documentation">TaskDoc</a>
		<a class="nav-location-item" data-nav-location="doc-javadoc" href="../../javadoc/index.html"title="Java API documentation">JavaDoc</a>
	</div>
</div>
<div class="container page-contents packagedoc">
	<div class="row">
		<div class="col-12 col-lg-3 col-xl-2 p-lg-0">
			<div class="doc-navigation-container">
				<label class="d-lg-none nav-collapse" for="doc-collapse-nav-label">
					<svg style="height: 1.5em;" viewBox="0 0 24 24">
					    <path fill="currentColor" d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z" />
					</svg>
					Navigation
				</label>
				<input style="display:none;" id="doc-collapse-nav-label" type="checkbox"/> 
				<div class="doc-nav">  <div class="doc-section">    <p class="section-title">Introduction</p><ul><li><a class="doc-nav-section-link" href="../index.html" title="Overview">Overview</a></li><li><a class="doc-nav-section-link" href="../gettingstarted.html" title="Getting started">Getting started</a></li></ul>  </div>  <div class="doc-section">    <p class="section-title">Usage</p><ul><li><a class="doc-nav-section-link" href="index.html" title="Overview">Overview</a></li><li><a class="doc-nav-section-link" href="compilationid.html" title="Compilation identifier">Compilation identifier</a></li><li class="doc-active doc-active-parent"><a class="doc-nav-section-link" href="optionmerging.html" title="Compiler option merging">Compiler option merging</a></li></ul>  </div></div>
			</div>
		</div>
		<div class="col-12 col-lg-9 col-xl-10 doc-page">
			<div class="sb-sponsors" style="display: none;">
	<span class="sb-sponsors-title">Sponsors</span>
	<div class="container">
		<div class="row">
			<div class="col-md-4 col-12">
				<a class="sb-sponsors-link"></a>
			</div>
			<div class="col-md-4 col-12">
				<a class="sb-sponsors-link"></a>
			</div>
			<div class="col-md-4 col-12">
				<a class="sb-sponsors-link"></a>
			</div>
		</div>
	</div>
</div>
			<div class="doc-content"><h1 id="compiler-option-merging">Compiler option merging<a class="doc-heading-anchor" href="#compiler-option-merging"></a></h1>
<p>Some tasks may support the operation of <em>compiler option merging</em>. It is a feature that dynamically merges other compiler options into the specified configuration.</p>
<p>Option merging usually consists of the following:</p>
<ul>
<li>A compilation task <a href="compilationid.html" title="Compilation identifier">compilation identifier</a>.</li>
<li>Explicit configuration on the compilation task.</li>
<li>A specified collection of compiler options.
<ul>
<li>Compiler options may or may not have individual compiler identifiers assigned to them.</li>
</ul>
</li>
<li>Other qualifier properties based on the associated task.</li>
</ul>
<p>Option merging is usually used to specify the compiler options in a different and maintainable way than directly on the task that is being invoked. A simple and great example for this is by specifying different linker options based on the identifier:</p>
<p>(Take from the <a href="../../../saker.msvc/doc/ccompile/linkeroptions.html" title="Linker options">saker.msvc</a> package.)</p>
<pre><code class="language-sakerscript"><span class="d">$options</span> = <span class="e">[</span>
	<span class="e">{</span>
		<span class="f">Identifier</span>: <span class="b">debug</span><span class="e">,</span>
		<span class="f">SimpleLinkerParameters</span>: <span class="e">[</span> <span class="b">/DEBUG</span><span class="e"> ]
	},</span>
	<span class="e">{</span>
		<span class="f">Identifier</span>: <span class="b">release</span><span class="e">,</span>
		<span class="f">SimpleLinkerParameters</span>: <span class="e">[</span> <span class="b">/LTCG</span><span class="e"> ]
	},</span>
<span class="e">]</span>
<span class="a"><a href="../../../saker.msvc/taskdoc/saker.msvc.clink.html" title="Task: saker.msvc.clink()">saker.msvc.clink</a>(</span>
	<span class="c">Input</span>: <span class="k">### ... ###</span>,
	<span class="c">Identifier: </span><span class="b">main-debug</span>,
	<span class="c">LinkerOptions: </span><span class="d">$options</span>
<span class="a">)</span>
<span class="a"><a href="../../../saker.msvc/taskdoc/saker.msvc.clink.html" title="Task: saker.msvc.clink()">saker.msvc.clink</a>(</span>
	<span class="c">Input</span>: <span class="k">### ... ###</span>,
	<span class="c">Identifier: </span><span class="b">main-release</span>,
	<span class="c">LinkerOptions: </span><span class="d">$options</span>
<span class="a">)</span>
</code></pre>
<p>In the above we use the <a href="https://docs.microsoft.com/en-us/cpp/build/reference/c-cpp-building-reference?view=vs-2019" title="C/C++ Building Reference - Visual Studio | Microsoft Docs">MSVC C/C++ compiler toolchain</a> to link some inputs. We specify the <code>LinkerOptions</code> parameter that consists of a list of additional compiler options.</p>
<p>We can see that one linker task has the <code>main-debug</code> and the other has the <code>main-release</code> compilation identifiers assigned to them. The <a href="../../../saker.msvc/taskdoc/saker.msvc.clink.html"><code>saker.msvc.clink()</code></a> task will take this, and attempt to merge the specified <code>LinkerOptions</code> if applicable.</p>
<p>It does the examination by checking if the compilation identifier specified in an option map is the <a href="compilationid.html#subset" title="Subset">subset</a> of the identifier of the linker task. If so, then it will merge the specified options when linking the inputs. In the end, this will cause that the input specified for <code>main-debug</code> will be linked with the <a href="https://docs.microsoft.com/en-us/cpp/build/reference/debug-generate-debug-info?view=vs-2019" title="/DEBUG (Generate Debug Info) | Microsoft Docs"><code>/DEBUG</code></a> flag, and the inputs for <code>main-release</code> are linked with the <a href="https://docs.microsoft.com/en-us/cpp/build/reference/ltcg-link-time-code-generation?view=vs-2019" title="/LTCG (Link-time Code Generation) | Microsoft Docs"><code>/LTCG</code></a> flag passed to the backend linker.</p>
<p>This is a great use-case for compilation identifiers, as it makes compiler options reusable for multiple compilation tasks without having the need for the developer to repeat themselves every time. Following up on the above example, adding the given linker flags can be achieved by simply appending <code>-release</code> or <code>-debug</code> to the compilation identifier of a linker task.</p>
<p><strong>Note</strong> that the actual rules for option merging may be specialized for a given use-case. For example, the above <a href="../../../saker.msvc/taskdoc/saker.msvc.clink.html"><code>saker.msvc.clink()</code></a> task will also take the <code>Architecture</code> of the task and compiler options into account.</p>
<link href="../../../css/sakerscript.css"  rel="stylesheet" type="text/css" /></div>
			<div class="end-section-links">
				<div class="end-section-prev">
					<a class="doc-prev-section" href="../../doc/usage/compilationid.html" title="Compilation identifier"><svg class="doc-section-arrow" viewBox="0 0 24 24">
    <path fill="currentColor" d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" />
</svg>Compilation identifier</a>
				</div>
				<div class="end-section-next">
					
				</div>
			</div>
			
		</div>
	</div>
</div>
<div class="doc-footer">
	<div class="container">
		<div class="row">
			<div class="footer-section col-6 col-sm-4 col-md-3">
				<p class="footer-section-title">About</p>
				<div><a href="/index.html" title="Saker.build home page">Home</a></div>
				<div data-footer-location="doc-docs"><a href="../../index.html" title="saker.compiler.utils documentation home">Documentation home</a></div>
				<div><a href="../../../saker.build/index.html" title="Information about the saker.build system">saker.build system</a></div>
				<div><a href="../../../saker.nest/index.html" title="Information about the saker.nest repository">saker.nest repository</a></div>
				<div><a href="/contact.html" title="Contact us">Contact</a></div>
			</div>
			<div class="footer-section col-6 col-sm-4 col-md-3">
				<p class="footer-section-title">Resources</p>
				<div data-footer-location="doc-docs"><a href="../../doc/index.html" title="saker.compiler.utils documentation home">Documentation</a></div>
				<div data-footer-location="doc-javadoc"><a href="../../javadoc/index.html" title="JavaDoc for saker.compiler.utils">JavaDoc</a></div>
				<div data-footer-location="doc-taskdoc"><a href="../../taskdoc/index.html"  title="Documentation of build tasks in saker.compiler.utils">TaskDoc</a></div>
				<div data-footer-location="nest-package"><a href="https://nest.saker.build/package/saker.compiler.utils" title="saker.compiler.utils | saker.nest">saker.nest package page</a></div>
				<div><a href="https://github.com/sakerbuild/saker.compiler.utils" title="saker.compiler.utils on GitHub">GitHub</a></div>
			</div>
		</div>	
		<div class="row">
			<div class="col">
			&copy; Bence Sipka 2020
			</div>
		</div>
	</div>
</div>


<script>
if(window.hasOwnProperty("hljs")){
	hljs.configure({
	  languages: []
	});
	hljs.initHighlightingOnLoad();
}
</script>

</body>
</html>