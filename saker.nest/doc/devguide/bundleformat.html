<!DOCTYPE html>
<html>
<head>
	<title>Bundle format&nbsp;|&nbsp;saker.nest</title>
	
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"/>
	
	<link rel="stylesheet" href="../../../res/bootstrap.min.css" >
	<link rel="stylesheet" href="../../../res/doc-saker.css" >
</head>
<body data-nav-location="packagedoc" data-subdoc-presence="nest-package packagedoc javadoc">
<div class="doc-nav-bar">
	<div class="container">
		<a class="home-link" href="../../index.html" title="saker.nest"><img style="height: 2.5em;" class="logo" src="../../../res/logo.svg"/><span class="page-name">saker.nest</span></a>
		<a class="nav-location-item" data-nav-location="doc-docs" href="../../doc/index.html" title="Documentation">Documentation</a>
		<a class="nav-location-item" data-nav-location="doc-taskdoc" href="../../taskdoc/index.html" title="Build task documentation">TaskDoc</a>
		<a class="nav-location-item" data-nav-location="doc-javadoc" href="../../javadoc/index.html"title="Java API documentation">JavaDoc</a>
	</div>
</div>
<div class="container page-contents packagedoc">
	<div class="row">
		<div class="col-12 col-lg-3 col-xl-2 p-lg-0">
			<div class="doc-navigation-container">
				<label class="d-lg-none nav-collapse" for="doc-collapse-nav-label">
					<svg style="height: 1.5em;" viewBox="0 0 24 24">
					    <path fill="currentColor" d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z" />
					</svg>
					Navigation
				</label>
				<input style="display:none;" id="doc-collapse-nav-label" type="checkbox"/> 
				<div class="doc-nav">  <div class="doc-section">    <p class="section-title">Introduction</p><ul><li><a class="doc-nav-section-link" href="../index.html" title="Overview">Overview</a></li><li><label class="doc-nav-collapse" for="_doc_collapse_id_0"><a class="doc-nav-section-link" href="../installation.html" title="Installation">Installation</a></label><input style="display:none;" id="_doc_collapse_id_0" type="checkbox"/><label class="doc-nav-section-arrow" for="_doc_collapse_id_0"></label><ul><li><a class="doc-nav-section-link" href="../releasearchive.html" title="Release archive">Release archive</a></li></ul></li><li><a class="doc-nav-section-link" href="../roadmap.html" title="Roadmap">Roadmap</a></li></ul>  </div>  <div class="doc-section">    <p class="section-title">User guide</p><ul><li><a class="doc-nav-section-link" href="../userguide/index.html" title="Repository structure">Repository structure</a></li><li><a class="doc-nav-section-link" href="../userguide/buildtasks.html" title="Build tasks">Build tasks</a></li><li><a class="doc-nav-section-link" href="../userguide/versioning.html" title="Versioning">Versioning</a></li><li><label class="doc-nav-collapse" for="_doc_collapse_id_1"><a class="doc-nav-section-link" href="../userguide/configuration.html" title="Runtime configuration">Runtime configuration</a></label><input style="display:none;" id="_doc_collapse_id_1" type="checkbox"/><label class="doc-nav-section-arrow" for="_doc_collapse_id_1"></label><ul><li><a class="doc-nav-section-link" href="../userguide/serverstorage.html" title="Server storage">Server storage</a></li><li><a class="doc-nav-section-link" href="../userguide/localstorage.html" title="Local storage">Local storage</a></li><li><a class="doc-nav-section-link" href="../userguide/paramsstorage.html" title="Parameter storage">Parameter storage</a></li><li><a class="doc-nav-section-link" href="../userguide/constraints.html" title="Constraint properties">Constraint properties</a></li></ul></li><li><a class="doc-nav-section-link" href="../userguide/localbundles.html" title="Local bundles">Local bundles</a></li><li><label class="doc-nav-collapse" for="_doc_collapse_id_2"><a class="doc-nav-section-link" href="../userguide/cmdlineref/index.html" title="Command line reference">Command line reference</a></label><input style="display:none;" id="_doc_collapse_id_2" type="checkbox"/><label class="doc-nav-section-arrow" for="_doc_collapse_id_2"></label><ul><li><a class="doc-nav-section-link" href="../userguide/cmdlineref/main.html" title="main">main</a></li><li><label class="doc-nav-collapse" for="_doc_collapse_id_3"><a class="doc-nav-section-link" href="../userguide/cmdlineref/local.html" title="local">local</a></label><input style="display:none;" id="_doc_collapse_id_3" type="checkbox"/><label class="doc-nav-section-arrow" for="_doc_collapse_id_3"></label><ul><li><a class="doc-nav-section-link" href="../userguide/cmdlineref/local_install.html" title="install">install</a></li></ul></li><li><label class="doc-nav-collapse" for="_doc_collapse_id_4"><a class="doc-nav-section-link" href="../userguide/cmdlineref/server.html" title="server">server</a></label><input style="display:none;" id="_doc_collapse_id_4" type="checkbox"/><label class="doc-nav-section-arrow" for="_doc_collapse_id_4"></label><ul><li><a class="doc-nav-section-link" href="../userguide/cmdlineref/server_upload.html" title="upload">upload</a></li></ul></li></ul></li></ul>  </div>  <div class="doc-section">    <p class="section-title">Repository website</p><ul><li><a class="doc-nav-section-link" href="../websiteguide/index.html" title="Overview">Overview</a></li><li><a class="doc-nav-section-link" href="../websiteguide/naming.html" title="Naming">Naming</a></li><li><a class="doc-nav-section-link" href="../websiteguide/uploading.html" title="Uploading bundles">Uploading bundles</a></li><li><a class="doc-nav-section-link" href="../websiteguide/publishing.html" title="Publishing">Publishing</a></li><li><a class="doc-nav-section-link" href="../websiteguide/descriptions.html" title="Descriptions">Descriptions</a></li><li><a class="doc-nav-section-link" href="../websiteguide/faq.html" title="FAQ">FAQ</a></li><li><a class="doc-nav-section-link" href="../websiteguide/repository_api.html" title="Repository web API">Repository web API</a></li></ul>  </div>  <div class="doc-section">    <p class="section-title">Development guide</p><ul><li><a class="doc-nav-section-link" href="index.html" title="Overview">Overview</a></li><li class="doc-active doc-active-parent"><a class="doc-nav-section-link" href="bundleformat.html" title="Bundle format">Bundle format</a></li><li><a class="doc-nav-section-link" href="dependencies.html" title="Dependencies">Dependencies</a></li><li><a class="doc-nav-section-link" href="classpath.html" title="Bundle classpath">Bundle classpath</a></li><li><a class="doc-nav-section-link" href="dependencyhell.html" title="Dependency hell">Dependency hell</a></li><li><a class="doc-nav-section-link" href="tasks.html" title="Build tasks">Build tasks</a></li><li><a class="doc-nav-section-link" href="runtimeaccess.html" title="Accessing the repository runtime">Accessing the repository runtime</a></li><li><a class="doc-nav-section-link" href="testing.html" title="Integration testing">Integration testing</a></li></ul>  </div></div>
			</div>
		</div>
		<div class="col-12 col-lg-9 col-xl-10 doc-page">
			<div class="sb-sponsors" style="display: none;">
	<span class="sb-sponsors-title">Sponsors</span>
	<div class="container">
		<div class="row">
			<div class="col-md-4 col-12">
				<a class="sb-sponsors-link"></a>
			</div>
			<div class="col-md-4 col-12">
				<a class="sb-sponsors-link"></a>
			</div>
			<div class="col-md-4 col-12">
				<a class="sb-sponsors-link"></a>
			</div>
		</div>
	</div>
</div>
			<div class="doc-content"><h1 id="bundle-format">Bundle format<a class="doc-heading-anchor" href="#bundle-format"></a></h1>
<p>The bundle contents are packed into a ZIP archive with additional meta-data added to them. (Also known as JAR files.) All bundles must contain a manifest file, and optionally dependency and build task declaration meta-data files.</p>
<h2 id="manifest-file">Manifest file<a class="doc-heading-anchor" href="#manifest-file"></a></h2>
<p>The manifest file for the bundle is expected to havethe path <code>META-INF/MANIFEST.MF</code>. It must be a well-formatted Java Manifest file, with additional <strong>required</strong> main attributes:</p>
<ul>
<li><code>Nest-Bundle-Format-Version</code>: An integer value that specifies the format version of the bundle. Currently the only accepted value is <code>1</code>. If the saker.nest repository introduces additional features, other version numbers may be supported later.</li>
<li><code>Nest-Bundle-Identifier</code>: Specifies the bundle identifier of the bundle. This is the full name of the bundle, including the package name, qualifiers, and a version qualifier. See <a href="../userguide/index.html#names" title="Names">Names</a> for information about the identifier format.</li>
</ul>
<p>A bundle that contains the above required manifest attributes is the absolute minimal requirements for a valid bundle.</p>
<p>In addition, the following <em>optional</em> meta-data attributes can be specified:</p>
<ul>
<li><code>Nest-Bundle-Source</code>: Specifies the bundle identifier of the bundle that contains the sources for this bundle.</li>
<li><code>Nest-Bundle-Documentation</code>: Specifies the bundle identifier of the bundle that contains documentational information for this bundle. The documentation resources are not expected to be in any format, they can be interpreted in an use-case dependent manner.</li>
</ul>
<p>In addition, the following <em>optional</em> behavioural attributes can be specified:</p>
<ul>
<li><code>Nest-ClassPath-Special</code>: Specifies special dependencies for the bundle that should be added to the bundle classpath when loaded. The currently accepted only value is <code>jdktools</code> which will cause the repository runtime to have the Java tooling classpath available for the bundle classes. (E.g. Java compiler)</li>
<li><code>Nest-ClassPath-Supported-JRE-Versions</code>: Specifies a <a href="../userguide/versioning.html#version-ranges" title="Version ranges">version range</a> that defines the suitable JRE environments that the bundle classes can be loaded on.</li>
<li><code>Nest-ClassPath-Supported-Repository-Versions</code>: Specifies a <a href="../userguide/versioning.html#version-ranges" title="Version ranges">version range</a> that defines the suitable repository versions that the bundle classes can be loaded on.</li>
<li><code>Nest-ClassPath-Supported-Build-System-Versions</code>: Specifies a <a href="../userguide/versioning.html#version-ranges" title="Version ranges">version range</a> that defines the suitable saker.build system versions that the bundle classes can be loaded on.</li>
<li><code>Nest-ClassPath-Supported-Architectures</code>: Specifies the suitable architectures that the bundle classes can be loaded on in a comma separated list.</li>
</ul>
<p>Any other manifest attribute that starts with <code>Nest-</code> prefix, and is not present in the above list may be rejected by the repository. They are considered to be reserved attributes.</p>
<p>The standard manifest attribute <code>Main-Class</code> can also be declared in the manifest. The repository runtime will read this value and validate that the referenced class is actually contained in the bundle.</p>
<h2 id="task-file">Task file<a class="doc-heading-anchor" href="#task-file"></a></h2>
<p>The tasks in the bundle can be declared in the <code>META-INF/nest/tasks</code> meta-data file. The contents of the file is a simple enumeration of the task names paired with the corresponding Java class names in the following format:</p>
<pre><code class="language-plaintext">[task.name]=[class-name]
</code></pre>
<p>Each entry should be on its separate line. Extra whitespace around the names and <code>=</code> sign are trimmed. Comments are not allowed. The bundle will be validated that it actually contains a class file for the given class name.</p>
<p>When a bundle is uploaded to the saker.nest repository, it will validate that the uploader has claimed all the task names that the bundle declares.</p>
<h2 id="dependency-file">Dependency file<a class="doc-heading-anchor" href="#dependency-file"></a></h2>
<p>The dependencies of a bundle can be declared in the <code>META-INF/nest/dependencies</code> meta-data file. The format of the dependency file is the following:</p>
<p>The dependencies are declared in 3 levels of white-space indented lines.</p>
<p>The first level contains the name of the bundle identifier that the dependency is declared on:</p>
<pre><code class="language-plaintext">my.bundle
    ...
second.dependency.bundle-q1-q2
    ....
</code></pre>
<p>The bundle identifiers may contain qualifiers, but no
meta-qualifiers. Each bundle identifier may only occurr once.
All dependency information for a bundle is written in the block following the bundle identifier.</p>
<p>In each indented block, the indentation characters must be the same. You can use one or more tabs or spaces, but
make sure to use the same indentation throughout an indented block.</p>
<p>A dependency on a bundle consists of one or multiple dependency kinds, a version range, and optional meta-data:</p>
<pre><code class="language-plaintext">my.bundle
    classpath: 1.0
    kind2, kind3,, kind4: [0)
</code></pre>
<p>The above shows two dependency declarations. The kind <code>classpath</code> is applied with the
<a href="../userguide/versioning.html#version-ranges" title="Version ranges">version range</a> of <code>1.0</code>. The dependency with kinds <code>kind2</code>,
<code>kind3</code>, <code>kind4</code> is applied with the version range of <code>[0)</code>.</p>
<p>A dependency declaration syntax consists of a dependency kind and version range separated by a colon character
(<code>:</code>). Multiple kinds can be present separated by commas. Extraneous commas are ignored.</p>
<p>In the above, both dependency declarations are indented with 4 spaces. As mentioned above, this must stay
consistend in a given block.</p>
<p>Dependency meta-datas can be declared for a given declaration:</p>
<pre><code class="language-plaintext">my.bundle
    classpath: 1.0
        optional: true
        meta2: custom-value
        with-spaces: hello world
        empty:
        quoted: &quot;123&quot;
        quoted: &quot;&quot;word&quot;&quot;
        multi-line: &quot;1
2&quot;
        eol-quote-escape: &quot;1&quot;\
2&quot;
        slash: \
        slash-in-str: &quot;\&quot;
</code></pre>
<p>There's two way the value of a meta-data declaration can be specified. As simple unquoted characters, or in
quotes. Without any quotation, the value will be considered to start from the colon (<code>:</code>) and last
until the end of the line. Any white-space will be trimmed from it.</p>
<p>With quotes, the contents of the meta-data value will be all the characters until the first quote that is found
at the end of a line. Intermediate quotes don't need to be escaped. If the value needs to have quotes at the end
of a line and still continue, the backslash (<code>\</code>) character needs to be appended to continue parsing
the value.</p>
<p>See the following for multi-line escaping examples:</p>
<pre><code class="language-plaintext">meta1: &quot;1st
2nd&quot;

meta2: &quot;some&quot;intermediate
&quot;quoted&quot;

meta3: &quot;quotes
at&quot;\
line\\
end&quot;
</code></pre>
<p>In the above, the meta-data entries will be the following, with new lines as <strong><code>\n</code></strong>:</p>
<ul>
<li><code>meta1</code>: <code>1st</code><strong><code>\n</code></strong><code>2nd</code></li>
<li><code>meta2</code>: <code>some&quot;intermediate</code><strong><code>\n</code></strong><code>&quot;quoted</code></li>
<li><code>meta3</code>: <code>quotes</code><strong><code>\n</code></strong><code>at&quot;</code><strong><code>\n</code></strong><code>line\</code><strong><code>\n</code></strong><code>end</code></li>
</ul>
<p>If a backslash character is found at the end of a line in a multi-line quoted string value, then it will be
omitted by the parser. Line endings are normalized to <code>\n</code>.</p>
<p>As a convenience feature, the parser allows version ranges to contain the <code>this</code> identifier. If found,
then it will be substituted by the version number of the declaring bundle identifier for
dependencies that have the same name as the declaring bundle.</p>
<p>E.g. if the declaring bundle is <code>my.bundle-v1.0</code> then the following:</p>
<pre><code class="language-plaintext">my.bundle-q1
    classpath: [this]
</code></pre>
<p>Will be parsed as if it was the following:</p>
<pre><code class="language-plaintext">my.bundle-q1
    classpath: [1.0]
</code></pre>
<p>Note that the <code>this</code> identifier will not be substituted if it is declared on a dependency that doesn't
have the same name as the declaring bundle. The following will result in a parsing error:</p>
<pre><code class="language-plaintext">other.bundle
    classpath: [this]
</code></pre>
<p>The error occurs as <code>other.bundle</code> has a different name than <code>my.bundle</code>.</p>
<link href="../../../css/sakerscript.css"  rel="stylesheet" type="text/css" /></div>
			<div class="end-section-links">
				<div class="end-section-prev">
					<a class="doc-prev-section" href="../../doc/devguide/index.html" title="Overview"><svg class="doc-section-arrow" viewBox="0 0 24 24">
    <path fill="currentColor" d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" />
</svg>Overview</a>
				</div>
				<div class="end-section-next">
					<a class="doc-next-section" href="../../doc/devguide/dependencies.html" title="Dependencies">Dependencies<svg class="doc-section-arrow" viewBox="0 0 24 24">
    <path fill="currentColor" d="M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z" />
</svg></a>
				</div>
			</div>
			<div class="doc-headings-nav">  <ul>    <li><a href="#bundle-format" title="Bundle format">Bundle format</a>      <ul>        <li><a href="#manifest-file" title="Manifest file">Manifest file</a>        </li>        <li><a href="#task-file" title="Task file">Task file</a>        </li>        <li><a href="#dependency-file" title="Dependency file">Dependency file</a>        </li>      </ul>    </li>  </ul></div>
		</div>
	</div>
</div>
<div class="doc-footer">
	<div class="container">
		<div class="row">
			<div class="footer-section col-6 col-sm-4 col-md-3">
				<p class="footer-section-title">About</p>
				<div><a href="/index.html" title="Saker.build home page">Home</a></div>
				<div data-footer-location="doc-docs"><a href="../../index.html" title="saker.nest documentation home">Documentation home</a></div>
				<div><a href="../../../saker.build/index.html" title="Information about the saker.build system">saker.build system</a></div>
				<div><a href="../../../saker.nest/index.html" title="Information about the saker.nest repository">saker.nest repository</a></div>
				<div><a href="/contact.html" title="Contact us">Contact</a></div>
			</div>
			<div class="footer-section col-6 col-sm-4 col-md-3">
				<p class="footer-section-title">Resources</p>
				<div data-footer-location="doc-docs"><a href="../../doc/index.html" title="saker.nest documentation home">Documentation</a></div>
				<div data-footer-location="doc-javadoc"><a href="../../javadoc/index.html" title="JavaDoc for saker.nest">JavaDoc</a></div>
				<div data-footer-location="doc-taskdoc"><a href="../../taskdoc/index.html"  title="Documentation of build tasks in saker.nest">TaskDoc</a></div>
				<div data-footer-location="nest-package"><a href="https://nest.saker.build/package/saker.nest" title="saker.nest | saker.nest">saker.nest package page</a></div>
				<div><a href="https://github.com/sakerbuild/saker.nest" title="saker.nest on GitHub">GitHub</a></div>
			</div>
		</div>	
		<div class="row">
			<div class="col">
			&copy; Bence Sipka 2020
			</div>
		</div>
	</div>
</div>

<link rel="stylesheet" href="../../../res/hljs.css"><script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.15.8/build/highlight.min.js" integrity="sha256-js+I1fdbke/DJrW2qXQlrw7VUEqmdeFeOW37UC0bEiU=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.13.1/build/languages/plaintext.min.js"></script>
<script>
if(window.hasOwnProperty("hljs")){
	hljs.configure({
	  languages: []
	});
	hljs.initHighlightingOnLoad();
}
</script>

</body>
</html>